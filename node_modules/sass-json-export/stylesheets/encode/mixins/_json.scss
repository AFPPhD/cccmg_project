/// JSON.stringify a value and pass it as a font-family of head element
/// @access public
/// @param {*} $value - value to be stringified
/// @param {String} $flag (all) - output driver
/// @require {function} json-encode
@mixin json-encode($value, $flag: 'all') {
  $flag: if(index('all' 'regular' 'media' 'comment', $flag), $flag, 'all');
  $json: json-encode($value);

  // Persistent comment
  @if $flag == 'comment' or $flag == 'all' {
    /*! json-encode: #{$json} */
  }
  // Regular property value pair
  @if $flag == 'regular' or $flag == 'all' {
    // All browsers except IE8-
    body {
      &:before { // :before (css2) more compatible than ::before (css3)
        // This element must be in the render tree to get it via getComputedStyle(document.body, ':before');
        content: json-encode($value);
        display: none; // To prevent screen readers reading this
        // display: block;
        // height: 0; Also screen reader will not read content within element with 0 height
        // overflow: hidden;
        // width: 0;
      }
    }

    // All browsers except Opera (Presto based)
    // head {
    //   font-family: json-encode($value);
    //   display: none;
    // }
  }

  // Falsy media query
  @if $flag == 'media' or $flag == 'all' {
    @media -json-encode {
      json {
        json: $json;
      }
    }
  }
}